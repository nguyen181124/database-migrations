# Di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u

TÃ´i coi viá»‡c di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ  má»™t trong nhá»¯ng váº¥n Ä‘á» khÃ³ chá»‹u nháº¥t pháº£i giáº£i quyáº¿t trong cuá»™c Ä‘á»i cá»§a má»™t ká»¹ sÆ° pháº§n má»m. KhÃ´ng chá»‰ váº­y, náº¿u nÃ³ gáº·p trá»¥c tráº·c, nhÆ° thÆ°á»ng lá»‡, má»i ngÆ°á»i cÃ³ xu hÆ°á»›ng náº£y sinh lo láº¯ng liÃªn quan Ä‘áº¿n báº¥t ká»³ thay Ä‘á»•i lÆ°á»£c Ä‘á»“ nÃ o.

Váº­y táº¡i sao nÃ³ láº¡i khÃ³ chá»‹u Ä‘áº¿n váº­y? Thoáº¡t nhÃ¬n thÃ¬ cÃ³ váº» Ä‘Æ¡n giáº£n nhÆ°ng khi báº¯t Ä‘áº§u nghÄ© vá» nÃ³ láº¡i ráº¥t khÃ³.

Khung lá»±a chá»n chÃ­nh cá»§a tÃ´i lÃ  Django dá»±a trÃªn Python, Ä‘Ã£ phÃ¡t hÃ nh cÃ¡c di chuyá»ƒn lÆ°á»£c Ä‘á»“ hÆ¡n má»™t tháº­p ká»· trÆ°á»›c vÃ  tÃ´i váº«n coi Ä‘Ã¢y lÃ  má»™t trong nhá»¯ng cÃ´ng cá»¥ di chuyá»ƒn tá»‘t nháº¥t mÃ  tÃ´i tá»«ng tháº¥y. (vÃ  tÃ´i Ä‘Ã£ lÃ m viá»‡c vá»›i nhiá»u framework khÃ¡c nhau trÃªn nhiá»u ngÃ´n ngá»¯).

NhÆ°ng ngay cáº£ vá»›i má»™t khung tuyá»‡t vá»i tá»± Ä‘á»™ng táº¡o cÃ¡c tá»‡p di chuyá»ƒn, lÆ°u trá»¯ cÃ¡c tham chiáº¿u di chuyá»ƒn trong cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  cho phÃ©p khÃ´i phá»¥c dá»… dÃ ng â€” cÃ³ ráº¥t nhiá»u Ä‘iá»u cáº§n cÃ¢n nháº¯c khi báº¡n thá»±c hiá»‡n di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u.

HÃ£y tÆ°á»Ÿng tÆ°á»£ng má»™t cÃ¡ch tiáº¿p cáº­n má»›i Ä‘á»ƒ tÃ¡ch trÆ°á»ng â€˜nameâ€™ thÃ nh â€˜first_nameâ€™ vÃ  â€˜last_nameâ€™ trong Báº£ng ngÆ°á»i dÃ¹ng. Má»i chuyá»‡n Ä‘ang diá»…n ra tá»‘t Ä‘áº¹p. Báº¡n thá»±c hiá»‡n di chuyá»ƒn lÆ°á»£c Ä‘á»“, cháº¡y táº­p lá»‡nh di chuyá»ƒn Ä‘á»ƒ chia dá»¯ liá»‡u cÅ© thÃ nh hai trÆ°á»ng vÃ  triá»ƒn khai API má»›i nháº¥t hoáº¡t Ä‘á»™ng vá»›i nhá»¯ng thay Ä‘á»•i nÃ y. Tuy nhiÃªn, cÃ³ Ä‘iá»u gÃ¬ Ä‘Ã³ khÃ´ng á»•n vá»›i cÃ¡c trÆ°á»ng má»›i. QuÃ¡ trÃ¬nh giÃ¡m sÃ¡t cá»§a báº¡n cho tháº¥y nhiá»u ngÆ°á»i dÃ¹ng duy nháº¥t khÃ´ng lÆ°u Ä‘Æ°á»£c do má»™t sá»‘ lá»—i xÃ¡c thá»±c, vÃ­ dá»¥: khÃ´ng pháº£i táº¥t cáº£ cÃ¡c kÃ½ tá»± Ä‘á»u Ä‘Æ°á»£c cháº¥p nháº­n. Sá»± cá»‘ nÃ y Ä‘Æ°á»£c coi lÃ  nghiÃªm trá»ng nÃªn báº¡n vÃ  nhÃ³m quyáº¿t Ä‘á»‹nh khÃ´i phá»¥c. Nghe cÃ³ váº» hay Ä‘áº¥y. Báº¡n hoÃ n nguyÃªn quÃ¡ trÃ¬nh di chuyá»ƒn lÆ°á»£c Ä‘á»“ vÃ  hoÃ n nguyÃªn á»©ng dá»¥ng vá» tráº¡ng thÃ¡i trÆ°á»›c Ä‘Ã³, nhÆ°ng sau Ä‘Ã³ báº¡n nháº­n tháº¥y ráº±ng viá»‡c ghi Ä‘ang diá»…n ra vá»›i cÃ¡c trÆ°á»ng má»›i trong khoáº£ng thá»i gian triá»ƒn khai nhá» Ä‘Ã³ vÃ  hiá»‡n táº¡i má»™t sá»‘ ngÆ°á»i dÃ¹ng bá»‹ thiáº¿u dá»¯ liá»‡u trong trÆ°á»ng tÃªn, dáº«n Ä‘áº¿n dá»¯ liá»‡u khÃ´ng nháº¥t quÃ¡n .

VÃ  giá» Ä‘Ã¢y, Ä‘á»™ phá»©c táº¡p tÄƒng thÃªm vá»›i yÃªu cáº§u thá»±c hiá»‡n táº¥t cáº£ nhá»¯ng viá»‡c Ä‘Ã³ mÃ  khÃ´ng cÃ³ thá»i gian ngá»«ng hoáº¡t Ä‘á»™ng.

    ğŸ„ VÃ­ dá»¥ nÃ y chá»‰ mang tÃ­nh giáº£ thuyáº¿t, nhÆ°ng Ä‘iá»u tÃ´i muá»‘n nÃ³i lÃ  viá»‡c di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u lÃ  nhá»¯ng váº¥n Ä‘á» phá»©c táº¡p cáº§n Ä‘Æ°á»£c giáº£i quyáº¿t báº±ng quy trÃ¬nh gá»“m nhiá»u bÆ°á»›c. TÃ´i cÅ©ng cÃ³ thá»ƒ liÃªn tÆ°á»Ÿng Ä‘áº¿n nhá»¯ng ngÆ°á»i thá»±c sá»± khÃ´ng muá»‘n tiáº¿p cáº­n nhá»¯ng váº¥n Ä‘á» nhÆ° váº­y - Ä‘Ã³ lÃ  má»™t quÃ¡ trÃ¬nh táº» nháº¡t khi báº¡n cáº§n pháº£i xÃ¡c minh dá»¯ liá»‡u liÃªn tá»¥c.

VÃ¬ váº­y, tÃ´i Ä‘Ã£ Ä‘á» cáº­p ráº±ng viá»‡c di chuyá»ƒn dá»¯ liá»‡u ráº¥t khÃ³ vÃ  khÃ´ng ai muá»‘n lÃ m viá»‡c vá»›i chÃºng, nhÆ°ng táº¡i sao? DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ i lÃ½ do:

1. Khi phÃ¡t triá»ƒn má»™t sáº£n pháº©m, báº¡n chá»‰ cÃ³ thá»ƒ tháº¥y trÆ°á»›c má»™t vÃ i thÃ¡ng, cÃ³ thá»ƒ má»™t nÄƒm, pháº§n má»m sáº½ phÃ¡t triá»ƒn nhÆ° tháº¿ nÃ o vÃ  báº¡n cÃ³ thá»ƒ chuáº©n bá»‹ nhÆ° tháº¿ nÃ o cho Ä‘iá»u Ä‘Ã³. Má»™t nÄƒm sau, [chá»§ sá»Ÿ há»¯u sáº£n pháº©m](https://vadimkravcenko.com/shorts/what-does-a-product-owner-do-all-day/) cÃ³ thá»ƒ Ä‘áº¿n gáº·p báº¡n vÃ  nÃ³i: â€œÄÆ°á»£c rá»“i, á»©ng dá»¥ng tÃ i chÃ­nh cá»§a chÃºng tÃ´i khÃ´ng cÃ²n dá»±a trÃªn giao dá»‹ch ná»¯a; má»i thá»© Ä‘á»u lÃ  Ä‘Äƒng kÃ½,â€ - rÃµ rÃ ng lÃ  má»™t quÃ¡ trÃ¬nh di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u khá»•ng lá»“ Ä‘á»ƒ phÃ¹ há»£p vá»›i trÆ°á»ng há»£p (hoáº·c xÃ¢y dá»±ng cÃ¡c giáº£i phÃ¡p thay tháº¿).

1. Thá»±c hiá»‡n di chuyá»ƒn cÅ©ng giá»‘ng nhÆ° lÃ m viá»‡c vá»›i dÃ¢y dáº«n trá»±c tiáº¿p. Báº¡n cÃ³ má»™t chiáº¿c Ä‘Ã¨n má»›i cáº§n treo trÃªn tráº§n nhÃ  nhÆ°ng báº¡n Ä‘ang lÃ m viá»‡c Ä‘Ã³ mÃ  khÃ´ng cáº§n táº¯t Ä‘iá»‡n. TÃ´i láº¥y chiáº¿c ÄÃ¨n lÃ m vÃ­ dá»¥ vÃ¬ hÃ´m qua tÃ´i Ä‘Ã£ treo má»™t chiáº¿c nÃªn nghÄ© Ä‘áº¿n nÃ³.

1. Má»i quÃ¡ trÃ¬nh di chuyá»ƒn mÃ  báº¡n Ä‘ang triá»ƒn khai (vÃ  Ä‘Ãºng váº­y, báº¡n cáº§n coi quÃ¡ trÃ¬nh di chuyá»ƒn lÃ  mÃ£ chá»© khÃ´ng chá»‰ lÃ  thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u) cáº§n pháº£i hoáº¡t Ä‘á»™ng vá»›i ba tÃ¬nh huá»‘ng khÃ¡c nhau:

    1. **Upgrading (Migrating up)** - tÃ­nh nÄƒng má»›i Ä‘Æ°á»£c xÃ¢y dá»±ng, mÃ´ hÃ¬nh dá»¯ liá»‡ Ä‘Æ°á»£c thÃªm/thay Ä‘á»•i/xÃ³a. CÃ¡c phiÃªn báº£n á»©ng dá»¥ng má»›i vÃ  cÅ© váº«n Ä‘Æ°á»£c ká»³ vá»ng sáº½ hoáº¡t Ä‘á»™ng nhÆ° mong Ä‘á»£i.

    1. **Downgrading (Migrating down)** - Ä‘Ã£ xáº£y ra lá»—i, dá»¯ liá»‡u khÃ´ng nháº¥t quÃ¡n - báº¡n cáº§n cÃ³ cÃ¡ch Ä‘á»ƒ quay láº¡i tráº¡ng thÃ¡i á»•n Ä‘á»‹nh trÆ°á»›c Ä‘Ã³ má»™t cÃ¡ch cÃ³ kiá»ƒm soÃ¡t. KhÃ´ng pháº£i vá»›i nhá»¯ng thay Ä‘á»•i thá»§ cÃ´ng trong DB.

    1. **Everything in between** - cÃ³ nghÄ©a lÃ  táº¥t cáº£ logic chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c quan tÃ¢m. Máº·c dÃ¹ ngÃ y nay, cÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ thá»±c hiá»‡n chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u trong khoáº£ng thá»i gian dÃ i hÆ¡n báº±ng tÃ­nh nÄƒng ghi kÃ©p hoáº·c khÃ¡i niá»‡m â€œbáº£ng maâ€ vá»›i sá»± trá»£ giÃºp cá»§a thÆ° viá»‡n gh-ost tá»« Github; chÃºng ta sáº½ nÃ³i vá» Ä‘iá»u nÃ y sau.

1. Viá»‡c di chuyá»ƒn dá»¯ liá»‡u cÅ©ng gáº·p váº¥n Ä‘á» vÃ¬ Ä‘Ã¢y thÆ°á»ng khÃ´ng pháº£i lÃ  cÃ´ng viá»‡c cá»§a má»™t ngÆ°á»i. Sá»± thay Ä‘á»•i mÃ´ hÃ¬nh dá»¯ liá»‡u cÃ ng lá»›n thÃ¬ cÃ ng cÃ³ nhiá»u ngÆ°á»i tham gia. Tá»‘t nháº¥t lÃ  nÃªn cÃ³ nhá»¯ng ngÆ°á»i khÃ¡c nhau á»Ÿ cháº¿ Ä‘á»™ chá» khi triá»ƒn khai, sáºµn sÃ ng tham gia KHI cÃ³ sá»± cá»‘ xáº£y ra. TÃ´i viáº¿t khi nÃ o vÃ¬ ráº¥t cÃ³ thá»ƒ cÃ³ Ä‘iá»u gÃ¬ Ä‘Ã³ sáº½ khÃ´ng diá»…n ra nhÆ° káº¿ hoáº¡ch á»Ÿ Ã­t nháº¥t má»™t trong cÃ¡c bÆ°á»›c.

## Triá»ƒn khai Ä‘Æ¡n giáº£n

![](img/simpledeployedeployment.svg) 

ÄÃ¢y lÃ  cÃ¡ch tiáº¿p cáº­n Ä‘Æ¡n giáº£n nháº¥t mÃ  báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n khi triá»ƒn khai má»™t tÃ­nh nÄƒng má»›i cÃ³ cÃ¡c thay Ä‘á»•i vá» cÆ¡ sá»Ÿ dá»¯ liá»‡u, nghÄ©a lÃ  náº¿u báº¡n Ä‘á»§ nhá» vÃ  cÃ³ thá»ƒ cho phÃ©p mÃ¬nh cÃ³ má»™t vÃ i giÃ¢y ngá»«ng hoáº¡t Ä‘á»™ng:

1. Äáº©y mÃ£ cá»§a báº¡n tá»›i Bitbucket/Github/Gitlab.

1. Triá»ƒn khai Ä‘Æ°á»£c kÃ­ch hoáº¡t.

1. CÃ¡c container docker má»›i Ä‘Æ°á»£c xÃ¢y dá»±ng

1. Di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  táº¥t cáº£ cÃ¡c táº­p lá»‡nh liÃªn quan Ä‘á»u Ä‘Æ°á»£c cháº¡y

1. CÃ¡c vÃ¹ng chá»©a Docker Ä‘Æ°á»£c khá»Ÿi Ä‘á»™ng láº¡i trÃªn mÃ¡y chá»§

TÃ´i Ä‘Ã£ tháº¥y ráº¥t nhiá»u ngÆ°á»i ghÃ©t cÃ¡ch tiáº¿p cáº­n Ä‘Æ¡n giáº£n nÃ y, nhÆ°ng tÃ´i pháº£i nÃ³i ráº±ng, nÃ³ á»•n thÃ´i. Viá»‡c triá»ƒn khai khÃ´ng cáº§n pháº£i Ä‘au Ä‘áº§u cho Ä‘áº¿n khi báº¡n Ä‘áº¡t Ä‘áº¿n má»©c khÃ´ng cÃ³ thá»i gian ngá»«ng hoáº¡t Ä‘á»™ng lÃ  Ä‘iá»u quan trá»ng Ä‘á»‘i vá»›i doanh nghiá»‡p.

CÃ¡ch tiáº¿p cáº­n trÃªn hoÃ n toÃ n há»£p lá»‡ náº¿u:

1. Báº¡n cÃ³ má»™t phiÃªn báº£n á»©ng dá»¥ng duy nháº¥t.

1. Báº¡n cÃ³ thá»ƒ cho phÃ©p mÃ¬nh cÃ³ vÃ i giÃ¢y ngá»«ng hoáº¡t Ä‘á»™ng.

1. Báº¡n Ä‘Ã£ thá»­ nghiá»‡m quÃ¡ trÃ¬nh di chuyá»ƒn theo giai Ä‘oáº¡n.

ÄÃ¢y khÃ´ng pháº£i lÃ  má»™t cÃ¡ch tiáº¿p cáº­n há»£p lá»‡ náº¿u:

1. Báº¡n Ä‘ang cháº¡y nhiá»u phiÃªn báº£n á»©ng dá»¥ng, Ä‘iá»u nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng dá»“n Ä‘uá»•i quÃ¡ trÃ¬nh di chuyá»ƒn vÃ  tráº¡ng thÃ¡i cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ´ng há»£p lá»‡.

1. Báº¡n cÃ³ nhiá»u dá»¯ liá»‡u vÃ  cáº§n chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u â€” Ä‘iá»u nÃ y sáº½ cháº·n quÃ¡ trÃ¬nh triá»ƒn khai hoáº·c cÃ³ thá»ƒ háº¿t thá»i gian chá».

1. Thá»i gian ngá»«ng hoáº¡t Ä‘á»™ng khÃ´ng pháº£i lÃ  má»™t lá»±a chá»n.

BÃ¢y giá» chÃºng ta Ä‘Ã£ lÃ m rÃµ cÃ¡ch tiáº¿p cáº­n Ä‘Æ¡n giáº£n nháº¥t Ä‘á»ƒ triá»ƒn khai cÃ¡c thay Ä‘á»•i, hÃ£y xem xÃ©t má»™t sá»‘ tÃ¬nh huá»‘ng di chuyá»ƒn khÃ¡c nhau mÃ  báº¡n sáº½ pháº£i giáº£i quyáº¿t trong sá»± nghiá»‡p [ká»¹ sÆ° pháº§n má»m](https://vadimkravcenko.com/shorts/habits-of-great-software-engineers/) cá»§a mÃ¬nh.

## Ká»‹ch báº£n

### ThÃªm má»™t trÆ°á»ng má»›i

ÄÃ¢y lÃ  [trÆ°á»ng há»£p dá»… nháº¥t](https://gist.github.com/majackson/493c3d6d4476914ca9da63f84247407b), vÃ¬ viá»‡c thÃªm trÆ°á»ng vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u vá» cÆ¡ báº£n lÃ  Ä‘iá»u khÃ´ng thá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c xÃ©t tá»« gÃ³c Ä‘á»™ á»©ng dá»¥ng cá»§a báº¡n vÃ  sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n logic hiá»‡n táº¡i theo báº¥t ká»³ cÃ¡ch nÃ o. TrÆ°á»ng má»›i sáº½ chá»‰ Ä‘Æ°á»£c truy cáº­p vÃ  sá»­ dá»¥ng khi á»©ng dá»¥ng má»›i Ä‘Æ°á»£c triá»ƒn khai.

Sau khi thÃªm trÆ°á»ng vÃ o ORM cá»§a báº¡n, hÃ£y táº¡o táº­p lá»‡nh di chuyá»ƒn khÃ´ng thá»ƒ thay Ä‘á»•i. Kiá»ƒm tra táº­p lá»‡nh nÃ y cá»¥c bá»™ Ä‘á»ƒ Ä‘áº£m báº£o nÃ³ hoáº¡t Ä‘á»™ng nhÆ° mong Ä‘á»£i. Di chuyá»ƒn tiáº¿n vÃ  lÃ¹i cáº§n Ä‘Æ°á»£c kiá»ƒm tra. Äá»«ng quÃªn thÃªm Ä‘á»“ Ä‘áº¡c vÃ o cÃ¡c bÃ i kiá»ƒm tra cho dá»¯ liá»‡u má»›i cá»§a báº¡n.

Náº¿u trÆ°á»ng má»›i khÃ´ng thá»ƒ rá»—ng, hÃ£y cung cáº¥p giÃ¡ trá»‹ máº·c Ä‘á»‹nh. Äiá»u nÃ y ráº¥t quan trá»ng Ä‘á»ƒ trÃ¡nh cÃ¡c váº¥n Ä‘á» xáº£y ra vá»›i cÃ¡c báº£n ghi hiá»‡n táº¡i khÃ´ng cÃ³ trÆ°á»ng nÃ y. Náº¿u cÃ³ liÃªn quan Ä‘áº¿n logic, vÃ­ dá»¥: trÆ°á»ng lÃ  tá»•ng há»£p cá»§a cÃ¡c trÆ°á»ng khÃ¡c â€” hÃ£y thÃªm logic vÃ o táº­p lá»‡nh di chuyá»ƒn. (TÃ´i Ä‘á» cáº­p bÃªn dÆ°á»›i lÃ½ do táº¡i sao khÃ¡i niá»‡m nÃ y chá»‰ hoáº¡t Ä‘á»™ng Ä‘á»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ dung lÆ°á»£ng tháº¥p ~ vÃ i triá»‡u hÃ ng vÃ  sáº½ khÃ´ng hoáº¡t Ä‘á»™ng Ä‘á»‘i vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u lá»›n.)

Táº­p trung vÃ o phÆ°Æ¡ng phÃ¡p triá»ƒn khai 2 giai Ä‘oáº¡n. Äáº§u tiÃªn, triá»ƒn khai cÃ¡c thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u. VÃ¬ viá»‡c thÃªm trÆ°á»ng má»›i sáº½ khÃ´ng phÃ¡ vá»¡ báº¥t ká»³ thay Ä‘á»•i nÃ o trong á»©ng dá»¥ng cá»§a báº¡n nÃªn thao tÃ¡c nÃ y sáº½ cháº¡y trÆ¡n tru ngay cáº£ vá»›i phiÃªn báº£n hiá»‡n táº¡i cá»§a á»©ng dá»¥ng. Sau khi báº¡n tin tÆ°á»Ÿng ráº±ng quÃ¡ trÃ¬nh di chuyá»ƒn Ä‘Ã£ thÃ nh cÃ´ng vÃ  khÃ´ng gÃ¢y ra báº¥t ká»³ sá»± cá»‘ nÃ o, hÃ£y triá»ƒn khai cÃ¡c thay Ä‘á»•i cá»§a á»©ng dá»¥ng.

Sau khi triá»ƒn khai (cÅ©ng nhÆ° trÆ°á»›c Ä‘Ã³), hÃ£y giÃ¡m sÃ¡t hiá»‡u suáº¥t cá»§a á»©ng dá»¥ng vÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u. HÃ£y chÃº Ã½ Ä‘áº¿n báº¥t ká»³ hÃ nh vi báº¥t ngá» nÃ o liÃªn quan Ä‘áº¿n lÄ©nh vá»±c má»›i cá»§a báº¡n.

BÃ¢y giá», hÃ£y quay láº¡i cÃ¡c trÆ°á»ng khÃ´ng thá»ƒ rá»—ng cÃ³ giÃ¡ trá»‹ máº·c Ä‘á»‹nh. ÄÃ¢y lÃ  lÃ½ do táº¡i sao cÃ¡c giÃ¡ trá»‹ máº·c Ä‘á»‹nh cÃ³ thá»ƒ Ä‘áº·c biá»‡t cÃ³ váº¥n Ä‘á» Ä‘á»‘i vá»›i cÃ¡c táº­p dá»¯ liá»‡u lá»›n:

1. Cáº­p nháº­t ngay láº­p tá»©c táº¥t cáº£ cÃ¡c hÃ ng - sau khi báº¡n thÃªm má»™t cá»™t má»›i cÃ³ giÃ¡ trá»‹ máº·c Ä‘á»‹nh, háº§u háº¿t cÃ¡c DB sáº½ cáº§n cáº­p nháº­t má»—i hÃ ng cÃ³ giÃ¡ trá»‹ Ä‘Ã³. Vá»›i hÃ ng tá»· hÃ ng, viá»‡c Ä‘Ã³ cÃ³ thá»ƒ máº¥t má»™t lÃºc.

1. Cáº­p nháº­t ngay láº­p tá»©c táº¥t cáº£ cÃ¡c hÃ ng - sau khi báº¡n thÃªm má»™t cá»™t má»›i cÃ³ giÃ¡ trá»‹ máº·c Ä‘á»‹nh, háº§u háº¿t cÃ¡c DB sáº½ cáº§n cáº­p nháº­t má»—i hÃ ng cÃ³ giÃ¡ trá»‹ Ä‘Ã³. Vá»›i hÃ ng tá»· hÃ ng, viá»‡c Ä‘Ã³ cÃ³ thá»ƒ máº¥t má»™t lÃºc.

1. 
    
![](img/image-2.png)

## XÃ³a má»™t trÆ°á»ng

BÃ¢y giá» chÃºng ta Ä‘ang Ä‘i sÃ¢u vÃ o ná»™i dung [phá»©c táº¡p hÆ¡n má»™t chÃºt](https://gist.github.com/majackson/493c3d6d4476914ca9da63f84247407b#removing-fields-or-tables), vÃ¬ báº¡n Ä‘ang xÃ³a ná»™i dung nÃ o Ä‘Ã³ Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng trong á»©ng dá»¥ng, vÃ¬ váº­y cÃ¡ch tiáº¿p cáº­n á»Ÿ Ä‘Ã¢y hÆ¡i khÃ¡c má»™t chÃºt.

BÆ°á»›c Ä‘áº§u tiÃªn diá»…n ra ráº¥t lÃ¢u trÆ°á»›c khi quÃ¡ trÃ¬nh di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u diá»…n ra. ÄÃ¡nh dáº¥u/Ä‘Ã¡nh dáº¥u mÃ£ sá»­ dá»¥ng â€œtrÆ°á»ng cáº§n xÃ³aâ€. Sau khi táº¥t cáº£ cÃ¡c vá»‹ trÃ­ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u, hÃ£y báº¯t Ä‘áº§u báº±ng viá»‡c loáº¡i bá» dáº§n viá»‡c sá»­ dá»¥ng trÆ°á»ng Ä‘Ã³ trong á»©ng dá»¥ng - trÆ°á»›c tiÃªn lÃ  loáº¡i bá» nháº­n xÃ©t.

    ğŸ„ (Optional) Before physically removing a field, consider if the data in that field might be needed in the future. If so, archive this data in a different location.

Náº¿u trong vÃ­ dá»¥ Ä‘áº§u tiÃªn, chÃºng tÃ´i Ä‘Ã£ triá»ƒn khai cÃ¡c thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u trÆ°á»›c thÃ¬ trong trÆ°á»ng há»£p nÃ y, chÃºng tÃ´i báº¯t Ä‘áº§u báº±ng cÃ¡ch triá»ƒn khai cÃ¡c thay Ä‘á»•i á»©ng dá»¥ng khÃ´ng cÃ²n sá»­ dá»¥ng trÆ°á»ng ná»¯a. Äáº£m báº£o á»©ng dá»¥ng á»•n Ä‘á»‹nh vá»›i viá»‡c sá»­ dá»¥ng trÆ°á»ng Ä‘Ã£ xÃ³a Ä‘Æ°á»£c nháº­n xÃ©t. Sau Ä‘Ã³, triá»ƒn khai di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ loáº¡i bá» trÆ°á»ng nÃ y. Quy trÃ¬nh hai bÆ°á»›c nÃ y Ä‘áº£m báº£o khÃ´ng cÃ³ ná»— lá»±c truy cáº­p vÃ o trÆ°á»ng sau khi trÆ°á»ng bá»‹ xÃ³a.

Trá»ng tÃ¢m cá»§a chÃºng tÃ´i lÃ  trÃ¡nh sá»± khÃ´ng nháº¥t quÃ¡n vá» dá»¯ liá»‡u báº±ng má»i giÃ¡, vÃ¬ váº­y náº¿u báº¡n triá»ƒn khai cÃ¡c thay Ä‘á»•i á»©ng dá»¥ng vÃ  tháº¥y trÆ°á»ng váº«n Ä‘Æ°á»£c cáº­p nháº­t â€” thÃ¬ báº¡n Ä‘Ã£ bá» lá»¡ Ä‘iá»u gÃ¬ Ä‘Ã³.

![](img/img-3.png)

## Thay Ä‘á»•i trÆ°á»ng cÃ³ kÃ¨m theo logic nghiá»‡p vá»¥

BÃ¢y giá» chÃºng ta Ä‘ang Ä‘i Ä‘áº¿n nhá»¯ng Ä‘iá»u tá»‘t Ä‘áº¹p. Thay Ä‘á»•i má»™t trÆ°á»ng Ä‘an xen vá»›i logic nghiá»‡p vá»¥ lÃ  má»™t trong nhá»¯ng tÃ¬nh huá»‘ng di chuyá»ƒn phá»©c táº¡p nháº¥t. CÃ¡c trÆ°á»ng há»£p tÆ°Æ¡ng tá»± bao gá»“m viá»‡c tÃ¡ch má»™t trÆ°á»ng tá»« má»™t báº£ng thÃ nh nhiá»u trÆ°á»ng trong má»™t báº£ng má»›i vÃ  di chuyá»ƒn toÃ n bá»™ dá»¯ liá»‡u sang má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c. Táº¥t cáº£ nhá»¯ng trÆ°á»ng há»£p nÃ y Ä‘á»u giá»‘ng nhau vá» cÃ¡ch xá»­ lÃ½.

ÄÃ¢y cÃ³ láº½ lÃ  nhá»¯ng trÆ°á»ng há»£p má»i ngÆ°á»i cá»‘ gáº¯ng trÃ¡nh vÃ  tÃ¬m cÃ¡ch giáº£i quyáº¿t. LÃ½ do lÃ  â€” tÃ¡c Ä‘á»™ng cá»§a nhá»¯ng thay Ä‘á»•i Ä‘Ã³ cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n nhiá»u pháº§n khÃ¡c nhau (báº¡n chÆ°a biáº¿t) cá»§a á»©ng dá»¥ng. ÄÃ³ lÃ  lÃ½ do táº¡i sao trÆ°á»ng há»£p nÃ y:

- nÃªn Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t Ä‘á»™i

- nÃªn Ä‘Æ°á»£c xá»­ lÃ½ báº±ng logic ghi kÃ©p

- nÃªn Ä‘Æ°á»£c xá»­ lÃ½ báº±ng cÃ¡ch triá»ƒn khai theo nhiá»u giai Ä‘oáº¡n (giÃºp má»i thá»© luÃ´n hoáº¡t Ä‘á»™ng mÃ  khÃ´ng cÃ³ sá»± mÃ¢u thuáº«n vá» dá»¯ liá»‡u)

TrÆ°á»›c khi thá»±c hiá»‡n báº¥t ká»³ mÃ£ hÃ³a nÃ o - hÃ£y hiá»ƒu toÃ n bá»™ pháº¡m vi thay Ä‘á»•i. XÃ¡c Ä‘á»‹nh táº¥t cáº£ cÃ¡c Ä‘Æ°á»ng dáº«n Ä‘á»c cÃ³ liÃªn quan trong á»©ng dá»¥ng vÃ  Ä‘Ã¡nh dáº¥u chÃºng lÃ  sáº¯p khÃ´ng Ä‘Æ°á»£c dÃ¹ng ná»¯a.

> "Viá»‡c tÃ¡i cáº¥u trÃºc táº¥t cáº£ cÃ¡c Ä‘Æ°á»ng dáº«n mÃ£ nÆ¡i chÃºng tÃ´i thay Ä‘á»•i Ä‘Äƒng kÃ½ Ä‘Æ°á»£c cho lÃ  pháº§n thÃ¡ch thá»©c nháº¥t trong quÃ¡ trÃ¬nh di chuyá»ƒn. Logic cá»§a Stripe Ä‘á»ƒ xá»­ lÃ½ cÃ¡c hoáº¡t Ä‘á»™ng Ä‘Äƒng kÃ½ (vÃ­ dá»¥: cáº­p nháº­t, chia tá»· lá»‡, gia háº¡n) tráº£i dÃ i hÃ ng nghÃ¬n dÃ²ng mÃ£ trÃªn nhiá»u dá»‹ch vá»¥.
ChÃ¬a khÃ³a Ä‘á»ƒ tÃ¡i cáº¥u trÃºc thÃ nh cÃ´ng sáº½ lÃ  quy trÃ¬nh tÄƒng dáº§n cá»§a chÃºng tÃ´i: chÃºng tÃ´i sáº½ tÃ¡ch cÃ ng nhiá»u Ä‘Æ°á»ng dáº«n mÃ£ vÃ o Ä‘Æ¡n vá»‹ nhá» nháº¥t cÃ ng tá»‘t Ä‘á»ƒ chÃºng tÃ´i cÃ³ thá»ƒ Ã¡p dá»¥ng tá»«ng thay Ä‘á»•i má»™t cÃ¡ch cáº©n tháº­n.
Hai báº£ng cá»§a chÃºng tÃ´i cáº§n nháº¥t quÃ¡n vá»›i nhau á»Ÿ má»i bÆ°á»›c. Äá»‘i vá»›i má»—i Ä‘Æ°á»ng dáº«n mÃ£, chÃºng tÃ´i sáº½ cáº§n sá»­ dá»¥ng má»™t phÆ°Æ¡ng phÃ¡p tiáº¿p cáº­n tá»•ng thá»ƒ Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c thay Ä‘á»•i cá»§a chÃºng tÃ´i Ä‘Æ°á»£c an toÃ n. ChÃºng ta khÃ´ng thá»ƒ chá»‰ thay tháº¿ cÃ¡c báº£n ghi má»›i báº±ng cÃ¡c báº£n ghi cÅ©: má»i logic cáº§n pháº£i Ä‘Æ°á»£c xem xÃ©t cáº©n tháº­n."

NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y tá»« vÃ­ dá»¥ vá» Stripe, ráº¥t nhiá»u bÆ°á»›c chuáº©n bá»‹ diá»…n ra trÆ°á»›c khi quÃ¡ trÃ¬nh di chuyá»ƒn báº¯t Ä‘áº§u. CÃ¡c Ä‘Æ°á»ng dáº«n mÃ£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh vÃ  tÃ¡i cáº¥u trÃºc Ä‘á»ƒ há»— trá»£ ghi/Ä‘á»c kÃ©p.

Ã nghÄ©a cá»§a viá»‡c di chuyá»ƒn ghi kÃ©p vá» cÆ¡ báº£n cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh cÃ¡c bÆ°á»›c sau:

1. ThÃªm trÆ°á»ng má»›i vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u (KhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n mÃ£ Ä‘ang cháº¡y).

1. Triá»ƒn khai mÃ£ á»©ng dá»¥ng má»›i, Ä‘Æ°á»£c cáº¥u trÃºc láº¡i, nÆ¡i báº¡n báº¯t Ä‘áº§u ghi vÃ o cáº£ trÆ°á»ng cÅ© vÃ  trÆ°á»ng má»›i, Ã¡p dá»¥ng logic nghiá»‡p vá»¥ má»›i tÆ°Æ¡ng á»©ng. Viá»‡c Ä‘á»c váº«n Ä‘Æ°á»£c thá»±c hiá»‡n tá»« con Ä‘Æ°á»ng cÅ©. Viá»‡c ghi vÃ o cáº£ hai trÆ°á»ng **pháº£i** diá»…n ra nhÆ° má»™t pháº§n cá»§a má»™t Giao dá»‹ch.

1. So sÃ¡nh dá»¯ liá»‡u vÃ  Ä‘áº£m báº£o nÃ³ nháº¥t quÃ¡n.

1. Viáº¿t mÃ£ di chuyá»ƒn Ä‘á»ƒ chuyá»ƒn Ä‘á»•i pháº§n cÃ²n láº¡i cá»§a dá»¯ liá»‡u tá»« trÆ°á»ng cÅ© sang trÆ°á»ng má»›i theo Ä‘Ãºng Ä‘á»‹nh dáº¡ng. (Hoáº·c sá»­ dá»¥ng gh-ost tá»« Github)

1. Triá»ƒn khai quÃ¡ trÃ¬nh di chuyá»ƒn vÃ  thay Ä‘á»•i Ä‘Æ°á»ng dáº«n Ä‘á»c sang trÆ°á»ng má»›i. ÄÆ°á»ng dáº«n ghi váº«n Ä‘áº¿n cáº£ hai trÆ°á»ng.

1. XÃ¡c minh á»©ng dá»¥ng vÃ  tÃ­nh nháº¥t quÃ¡n cá»§a dá»¯ liá»‡u.

1. XÃ³a vÄƒn báº£n vÃ o trÆ°á»ng cÅ©. Táº¡i thá»i Ä‘iá»ƒm nÃ y, viá»‡c Ä‘á»c/ghi chá»‰ diá»…n ra trong lÄ©nh vá»±c má»›i. TrÆ°á»ng cÅ© váº«n tá»“n táº¡i trong cÆ¡ sá»Ÿ dá»¯ liá»‡u nhÆ°ng sáº½ khÃ´ng Ä‘Æ°á»£c ghi.

1. XÃ¡c minh á»©ng dá»¥ng vÃ  tÃ­nh nháº¥t quÃ¡n cá»§a dá»¯ liá»‡u.

1. XÃ³a má»i mÃ£ liÃªn quan Ä‘áº¿n trÆ°á»ng cÅ©.

1. XÃ¡c minh á»©ng dá»¥ng vÃ  tÃ­nh nháº¥t quÃ¡n cá»§a dá»¯ liá»‡u.

1. Triá»ƒn khai táº­p lá»‡nh di chuyá»ƒn Ä‘á»ƒ loáº¡i bá» cá»™t khá»i cÆ¡ sá»Ÿ dá»¯ liá»‡u.

1.Báº¯t tay vá»›i Ä‘á»“ng Ä‘á»™i cá»§a báº¡n.

TÃ´i hy vá»ng pháº§n phÃ¢n tÃ­ch chi tiáº¿t nÃ y sáº½ giÃºp báº¡n hÃ¬nh dung Ä‘Æ°á»£c quy trÃ¬nh thá»±c hiá»‡n cÃ¡c thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u phá»©c táº¡p. Má»—i bÆ°á»›c cÃ³ thá»ƒ Ä‘Æ°á»£c khÃ´i phá»¥c riÃªng láº», mang láº¡i sá»± á»•n Ä‘á»‹nh cao hÆ¡n so vá»›i viá»‡c thá»±c hiá»‡n táº¥t cáº£ cÃ¡c thay Ä‘á»•i cÃ¹ng má»™t lÃºc. CÃ¡ch tiáº¿p cáº­n nÃ y khÃ´ng chá»‰ lÃ m giáº£m kháº£ nÄƒng xáº£y ra lá»—i mÃ  cÃ²n Ä‘áº£m báº£o ráº±ng náº¿u xáº£y ra lá»—i, chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­a chá»¯a mÃ  khÃ´ng gÃ¢y máº¥t mÃ¡t hoáº·c mÃ¢u thuáº«n dá»¯ liá»‡u.

## á»¨ng dá»¥ng di Ä‘á»™ng + di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u

Trong khi nghiÃªn cá»©u chá»§ Ä‘á» nÃ y, tÃ´i tÃ¬nh cá» nghe Ä‘Æ°á»£c má»™t cuá»™c nÃ³i chuyá»‡n vá» cÃ¡ch [DoorDash chia cÆ¡ sá»Ÿ dá»¯ liá»‡u Postgres](https://yowcon.com/sydney-2022/sessions/2373/migrations-the-hardest-actual-problem-in-computer-science) cá»§a há» thÃ nh nhiá»u cÆ¡ sá»Ÿ dá»¯ liá»‡u nhá» hÆ¡n vÃ  há» Ä‘á» xuáº¥t má»™t cÃ¡ch tiáº¿p cáº­n khÃ¡c (Má»™t biáº¿n thá»ƒ cá»§a cÃ¡ch viáº¿t kÃ©p)

VÃ¬ DoorDash lÃ  má»™t á»©ng dá»¥ng di Ä‘á»™ng nÃªn cÃ¡c phiÃªn báº£n cÅ© cá»§a á»©ng dá»¥ng váº«n Ä‘Æ°á»£c sá»­ dá»¥ng khi há» phÃ¡t hÃ nh phiÃªn báº£n má»›i. Do Ä‘Ã³, viá»‡c di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u trá»Ÿ thÃ nh má»™t váº¥n Ä‘á» lá»›n vÃ¬ báº¡n pháº£i tÆ°Æ¡ng thÃ­ch ngÆ°á»£c vá»›i dá»¯ liá»‡u Ä‘áº¿n tá»« nhiá»u phiÃªn báº£n á»©ng dá»¥ng cÅ© hÆ¡n.

Há» Ä‘Ã£ thá»­ cÃ¡c phiÃªn báº£n khÃ¡c nhau cá»§a tÃ­nh nÄƒng ghi kÃ©p vÃ  cÃ¡ch tiáº¿p cáº­n thá»© ba Ä‘Ã¡ng ngáº¡c nhiÃªn:

1. Ghi kÃ©p dá»±a trÃªn API - TrÃ¬nh bao bá»c API xung quanh Dá»‹ch vá»¥ cÅ© vÃ  Dá»‹ch vá»¥ má»›i

1. Ghi kÃ©p dá»±a trÃªn cÆ¡ sá»Ÿ dá»¯ liá»‡u - CÃ¹ng má»™t API, nhÆ°ng ghi/Ä‘á»c Ä‘Æ°á»£c kÃ­ch hoáº¡t cho hai cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c nhau

1. PhiÃªn báº£n á»©ng dá»¥ng má»›i + Äiá»ƒm cuá»‘i má»›i + CÆ¡ sá»Ÿ dá»¯ liá»‡u má»›i - PhiÃªn báº£n á»©ng dá»¥ng má»›i vá»›i Ä‘iá»ƒm cuá»‘i khÃ¡c Ä‘á»c/ghi vÃ o cÃ¡c cÆ¡ sá»Ÿ dá»¯ liá»‡u khÃ¡c nhau dá»±a trÃªn logic cÅ©/má»›i. ÄÃ¢y cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i lÃ  Ghi kÃ©p cáº¥p á»©ng dá»¥ng, vÃ¬ phiÃªn báº£n á»©ng dá»¥ng má»›i xÃ¡c Ä‘á»‹nh dá»¯ liá»‡u cÅ©/má»›i sáº½ Ä‘i Ä‘áº¿n Ä‘Ã¢u.

![](img/img-4.png)

TÃ´i tháº¥y tháº­t thÃº vá»‹ khi cÃ¡c cÃ´ng ty khÃ¡c thá»±c hiá»‡n nhá»¯ng thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u phá»©c táº¡p, vÃ¬ váº­y tÃ´i thá»±c sá»± khuyÃªn báº¡n nÃªn Ä‘á»c thÃªm má»™t sá»‘ bÃ i viáº¿t vá» chá»§ Ä‘á» nÃ y:

1. TrÆ°á»ng há»£p sá»c: [Di chuyá»ƒn Ä‘Äƒng kÃ½](https://stripe.com/blog/online-migrations)

1. TrÆ°á»ng há»£p Facebook: [Di chuyá»ƒn Messenger](https://engineering.fb.com/2018/06/26/core-infra/migrating-messenger-storage-to-optimize-performance/)

1. TrÆ°á»ng há»£p Gusto: [Miá»…n trá»« di chuyá»ƒn](https://engineering.gusto.com/old-write/)

1. Há»™p Ä‘á»±ng: [Chuyá»ƒn tá»« HBase sang Google BigTable](https://medium.com/box-tech-blog/zero-downtime-migration-from-hbase-to-bigtable-4f00f835755f)

## KhÃ´ng cÃ³ thá»i gian cháº¿t

HÃ£y nÃ³i nhiá»u hÆ¡n vá» thá»i gian ngá»«ng hoáº¡t Ä‘á»™ng báº±ng khÃ´ng.

KhÃ´ng pháº£i táº¥t cáº£ cÃ¡c á»©ng dá»¥ng, Ä‘áº·c biá»‡t lÃ  nhá»¯ng á»©ng dá»¥ng phá»¥c vá»¥ Ä‘á»‘i tÆ°á»£ng toÃ n cáº§u, Ä‘á»u cÃ³ thá»i gian báº£o trÃ¬ sang trá»ng. Äá»‘i vá»›i cÃ¡c ná»n táº£ng toÃ n cáº§u nhÆ° Google, Facebook, LinkedIn vÃ  Netflix, khÃ´ng cÃ³ thá»i gian "ngoÃ i giá» cao Ä‘iá»ƒm". Máº·t trá»i khÃ´ng bao giá» láº·n Ä‘á»‘i vá»›i cÆ¡ sá»Ÿ ngÆ°á»i dÃ¹ng cá»§a há», khiáº¿n báº¥t ká»³ thá»i gian ngá»«ng hoáº¡t Ä‘á»™ng nÃ o Ä‘á»u gÃ¢y báº¥t lá»£i cho tráº£i nghiá»‡m vÃ  doanh thu cá»§a ngÆ°á»i dÃ¹ng. Náº¿u má»™t trong sá»‘ nÃ y bá»‹ há»ng - Ä‘Ã³ thÆ°á»ng lÃ  cÃ¢u chuyá»‡n sá»‘ 1 trÃªn HackerNews.

ÄÃ´i khi tÃ´i ngáº¡c nhiÃªn khi nháº­n Ä‘Æ°á»£c email tá»« cÃ¡c nhÃ  cung cáº¥p cá»•ng thanh toÃ¡n cho biáº¿t há» sáº½ cÃ³ thá»i gian báº£o trÃ¬ vÃ o tuáº§n tá»›i. Vá» cÆ¡ báº£n, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  báº¡n sáº½ khÃ´ng nháº­n Ä‘Æ°á»£c tiá»n trong thá»i gian nÃ yâ€¦ xin lá»—i vÃ¬ Ä‘iá»u Ä‘Ã³.

TÃ´i Ä‘ang cá»‘ gáº¯ng nÃ³i ráº±ng báº¡n cÃ ng lá»›n thÃ¬ dá»‹ch vá»¥ cá»§a báº¡n cÃ ng trá»Ÿ nÃªn quan trá»ng trong kinh doanh vÃ  báº¡n cÃ ng nháº­n Ä‘Æ°á»£c Ã­t thá»i gian báº£o trÃ¬ hÆ¡n. Náº¿u khÃ´ng cÃ³ thá»i gian báº£o trÃ¬ - khÃ´ng cÃ³ thá»i gian ngá»«ng hoáº¡t Ä‘á»™ng lÃ  cÃ¡ch duy nháº¥t. CÃ³, chÃºng thÆ°á»ng máº¥t nhiá»u thá»i gian hÆ¡n vÃ¬ chÃºng Ä‘Æ°á»£c triá»ƒn khai theo nhiá»u giai Ä‘oáº¡n Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng dá»‹ch vá»¥ khÃ´ng bá»‹ giÃ¡n Ä‘oáº¡n á»Ÿ báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o. Tuy nhiÃªn, cÃ¡ch tiáº¿p cáº­n theo tá»«ng giai Ä‘oáº¡n nÃ y, máº·c dÃ¹ tá»‘n nhiá»u thá»i gian, nhÆ°ng láº¡i lÃ  sá»± Ä‘Ã¡nh Ä‘á»•i cáº§n thiáº¿t Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh liÃªn tá»¥c cá»§a dá»‹ch vá»¥ vÃ  quan trá»ng hÆ¡n lÃ  tÃ­nh nháº¥t quÃ¡n cá»§a dá»¯ liá»‡u.

Tuy nhiÃªn, khÃ´ng pháº£i táº¥t cáº£ cÃ¡c dá»‹ch vá»¥ Ä‘á»u quan trá»ng Ä‘á»‘i vá»›i hoáº¡t Ä‘á»™ng kinh doanh vÃ  lÃ½ do chÃ­nh dáº«n Ä‘áº¿n thá»i gian ngá»«ng hoáº¡t Ä‘á»™ng Ä‘á»‘i vá»›i cÃ¡c cÃ´ng ty khÃ´ng thuá»™c cáº¥p Google lÃ  do khÃ´ng duy trÃ¬ Ä‘Æ°á»£c kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch ngÆ°á»£c cá»§a mÃ£ vá»›i nhá»¯ng thay Ä‘á»•i má»›i vÃ  quÃ¡ trÃ¬nh di chuyá»ƒn cÆ¡ sá»Ÿ dá»¯ liá»‡u kÃ©o dÃ i cá»§a há».

Náº¿u báº¡n khÃ´ng cÃ³ nhÃ³m SRE lá»›n Ä‘á»ƒ giÃºp báº¡n triá»ƒn khai, tÃ´i khuyÃªn báº¡n nÃªn lÃ m cho cuá»™c sá»‘ng cá»§a mÃ¬nh tá»‘t hÆ¡n má»™t chÃºt báº±ng má»™t sá»‘ cÃ´ng cá»¥ cho phÃ©p thay Ä‘á»•i lÆ°á»£c Ä‘á»“ tá»©c thá»i, khÃ´ng bá»‹ cháº·n cÅ©ng nhÆ° cÃ¡c báº£ng ma Ä‘á»ƒ di chuyá»ƒn dá»¯ liá»‡u:

1. náº¿u báº¡n Ä‘ang sá»­ dá»¥ng MySQL - hÃ£y cÃ¢n nháº¯c sá»­ dá»¥ng [gh-ost](https://github.com/github/gh-ost) báº¥t kháº£ tri cá»§a khung tá»« Github hoáº·c [MySQL Online DDL](https://dev.mysql.com/doc/refman/8.0/en/innodb-online-ddl.html) hoáº·c [pt-online-schema-change](https://docs.percona.com/percona-toolkit/pt-online-schema-change.html) hoáº·c Facebook [OnlineSchemaChange](https://github.com/facebookincubator/OnlineSchemaChange) hoáº¡t Ä‘á»™ng theo [cÃ¡ch tÆ°Æ¡ng tá»±](https://github.com/facebookincubator/OnlineSchemaChange/wiki/How-OSC-works) nhÆ° gh-ost.

1. náº¿u báº¡n Ä‘ang sá»­ dá»¥ng Postgres vÃ  Ä‘ang sá»­ dá»¥ng Django - hÃ£y thá»­ [django-pg-zero-downtime-migrations](https://github.com/tbicr/django-pg-zero-downtime-migrations) hoáº·c Yandex [zero-downtime-migrations](https://github.com/yandex/zero-downtime-migrations), Ä‘Ã¢y cÅ©ng lÃ  [má»™t sá»‘ nháº­n xÃ©t cá»§a HN vá» thÆ° viá»‡n](https://news.ycombinator.com/item?id=18281639).

1. NgoÃ i ra cÃ²n cÃ³ [SchemaHero](https://github.com/schemahero/schemahero) â€” má»™t cÃ´ng cá»¥ di chuyá»ƒn lÆ°á»£c Ä‘á»“ cÆ¡ sá»Ÿ dá»¯ liá»‡u nguá»“n má»Ÿ giÃºp chuyá»ƒn Ä‘á»•i Ä‘á»‹nh nghÄ©a lÆ°á»£c Ä‘á»“ thÃ nh cÃ¡c táº­p lá»‡nh di chuyá»ƒn cÃ³ thá»ƒ Ã¡p dá»¥ng trong má»i mÃ´i trÆ°á»ng.

![](img/img-5.png)

## Pháº§n káº¿t luáº­n

HÃ£y káº¿t thÃºc bÃ i viáº¿t báº±ng má»™t sá»‘ phÆ°Æ¡ng phÃ¡p hay nháº¥t:

1. KhÃ´ng cÃ³ thay Ä‘á»•i cÆ¡ sá»Ÿ dá»¯ liá»‡u thá»§ cÃ´ng. LuÃ´n táº¡o cÃ¡c táº­p lá»‡nh di chuyá»ƒn báº¥t biáº¿n.

1. PhiÃªn báº£n cÆ¡ sá»Ÿ dá»¯ liá»‡u pháº£i Ä‘Æ°á»£c chá»©a trong chÃ­nh cÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Ã³. (Django thá»±c hiá»‡n viá»‡c nÃ y má»™t cÃ¡ch tá»± Ä‘á»™ng)

1. Náº¿u báº¡n khÃ´ng cÃ³ cá»­a sá»• báº£o trÃ¬ - hÃ£y táº­p trung vÃ o quy trÃ¬nh ghi kÃ©p.

1. Khi xÃ¢y dá»±ng cÃ¡c tÃ­nh nÄƒng cÃ³ nhá»¯ng thay Ä‘á»•i quan trá»ng vá» cÆ¡ sá»Ÿ dá»¯ liá»‡u - hÃ£y nghÄ© Ä‘áº¿n kháº£ nÄƒng tÆ°Æ¡ng thÃ­ch ngÆ°á»£c vÃ  [sá»­a lá»—i trá»«u tÆ°á»£ng](https://files.gotocon.com/uploads/slides/conference_60/2373/original/Yow%202022%20-%20Migrations.pdf).

1. HÃ£y cÃ¢n nháº¯c viá»‡c sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ má»›i nháº¥t Ä‘á»ƒ giÃºp quÃ¡ trÃ¬nh di chuyá»ƒn cá»§a báº¡n trá»Ÿ nÃªn dá»… dÃ ng hÆ¡n.

1. CÃ²n gÃ¬ ná»¯a? Äá» xuáº¥t má»™t sá»‘ trong cÃ¡c Ã½ kiáº¿n â€‹â€‹:)